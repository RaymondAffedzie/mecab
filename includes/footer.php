        <!--Footer-->
        </div>

        <div class="container">
            <footer class="py-5">
                <div class="row">
                    <div class="col-6 col-md-2 mb-3">
                        <h5>Quick shop</h5>
                        <ul class="nav flex-column">
                            <li class="nav-item mb-2"><a href="mechanics.php" class="nav-link p-0 text-body-secondary">Mechanics</a></li>
                            <li class="nav-item mb-2"><a href="#" class="nav-link p-0 text-body-secondary">Spare parts</a></li>
                            <li class="nav-item mb-2"><a href="#" class="nav-link p-0 text-body-secondary">Transport</a></li>
                            <li class="nav-item mb-2"><a href="#" class="nav-link p-0 text-body-secondary">Car rentals</a></li>
                            <li class="nav-item mb-2"><a href="#" class="nav-link p-0 text-body-secondary">Job offers</a></li>
                            <li class="nav-item mb-2"><a href="about-us.php" class="nav-link p-0 text-body-secondary">About us</a></li>
                        </ul>
                    </div>

                    <div class="col-6 col-md-2 mb-3">
                        <h5>Section</h5>
                        <ul class="nav flex-column">
                            <li class="nav-item mb-2"><a href="#" class="nav-link p-0 text-body-secondary">Home</a></li>
                            <li class="nav-item mb-2"><a href="#" class="nav-link p-0 text-body-secondary">Features</a></li>
                            <li class="nav-item mb-2"><a href="#" class="nav-link p-0 text-body-secondary">Pricing</a></li>
                            <li class="nav-item mb-2"><a href="#" class="nav-link p-0 text-body-secondary">FAQs</a></li>
                            <li class="nav-item mb-2"><a href="#" class="nav-link p-0 text-body-secondary">About</a></li>
                        </ul>
                    </div>

                    <div class="col-6 col-md-2 mb-3">
                        <h5>Section</h5>
                        <ul class="nav flex-column">
                            <li class="nav-item mb-2"><a href="#" class="nav-link p-0 text-body-secondary">Home</a></li>
                            <li class="nav-item mb-2"><a href="#" class="nav-link p-0 text-body-secondary">Features</a></li>
                            <li class="nav-item mb-2"><a href="#" class="nav-link p-0 text-body-secondary">Pricing</a></li>
                            <li class="nav-item mb-2"><a href="#" class="nav-link p-0 text-body-secondary">FAQs</a></li>
                            <li class="nav-item mb-2"><a href="#" class="nav-link p-0 text-body-secondary">About</a></li>
                        </ul>
                    </div>

                    <div class="col-md-5 offset-md-1 mb-3">
                        <form>
                            <h5>Subscribe to our newsletter</h5>
                            <p>Monthly digest of what's new and exciting from us.</p>
                            <div class="d-flex flex-column flex-sm-row w-100 gap-2">
                                <label for="newsletter1" class="visually-hidden">Email address</label>
                                <input id="newsletter1" type="text" class="form-control" placeholder="Email address">
                                <button class="btn btn-primary" type="button">Subscribe</button>
                            </div>
                        </form>
                    </div>
                </div>

                <div class="d-flex flex-column flex-sm-row justify-content-between py-4 my-4 border-top">
                    <p>MeCAB © <?= date('Y'); ?>. All rights reserved.</p>
                    <ul class="list-unstyled d-flex">
                        <li class="ms-3"><a class="link-body-emphasis" href="#"><svg class="bi" width="24" height="24">
                                    <use xlink:href="#twitter"></use>
                                </svg></a></li>
                        <li class="ms-3"><a class="link-body-emphasis" href="#"><svg class="bi" width="24" height="24">
                                    <use xlink:href="#instagram"></use>
                                </svg></a></li>
                        <li class="ms-3"><a class="link-body-emphasis" href="#"><svg class="bi" width="24" height="24">
                                    <use xlink:href="#facebook"></use>
                                </svg></a></li>
                    </ul>
                </div>
            </footer>
        </div>

        <!--         
        <footer id="footer">
            <div class="site-footer">
                <div class="container"> -->
        <!--Footer Links-->
        <!-- <div class="footer-top">
                        <div class="row">
                            <div class="col-12 col-sm-12 col-md-3 col-lg-3 footer-links">
                                <h4 class="h4">Quick Shop</h4>
                                <ul>
                                    <li><a href="#">Spare Parts</a></li>
                                    <li><a href="#">Mechanic</a></li>
                                    <li><a href="#">Car Rentals</a></li>
                                    <li><a href="#">Transport</a></li>
                                </ul>
                            </div>
                            <div class="col-12 col-sm-12 col-md-3 col-lg-3 footer-links">
                                <h4 class="h4">Informations</h4>
                                <ul>
                                    <li><a href="../about-us.php">About us</a></li>
                                    <li><a href="#">Job</a></li>
                                    <li><a href="#">Privacy policy</a></li>
                                    <li><a href="terms-and-conditions.php">Terms &amp; condition</a></li>
                                    <li><a href="#">My Account</a></li>
                                </ul>
                            </div>
                            <div class="col-12 col-sm-12 col-md-3 col-lg-3 footer-links">
                                <h4 class="h4">Customer Services</h4>
                                <ul> -->
        <!-- <li><a href="#">Request Personal Data</a></li> -->
        <!-- <li><a href="#">FAQ's</a></li>
                                    <li><a href="#">Contact Us</a></li>
                                    <li><a href="#">Orders and Returns</a></li>
                                    <li><a href="#">Support Center</a></li>
                                </ul>
                            </div>
                            <div class="col-12 col-sm-12 col-md-3 col-lg-3 contact-box">
                                <ul class="addressFooter">
                                    <h4 class="h4">Contact Us</h4>
                                    <li class="phone">
                                        <i class="mdi mdi-phone text-light p-1"></i>+233(0)244791855
                                    </li>
                                    <li class="email">
                                        <i class="ti-info-alt text-light p-1"></i>info@mecab.org
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div> -->
        <!--End Footer Links-->
        <!-- <hr>
                    <div class="footer-bottom">
                        <div class="row"> -->
        <!--Footer Copyright-->
        <!-- <div class="col-12 col-sm-12 col-md-6 col-lg-6 order-1 order-md-0 order-lg-0 order-sm-1 copyright text-sm-center text-md-left text-lg-left">
                                <span></span>
                                <a href="#">Copyright © <? //= date("Y") 
                                                        ?> MeCAB. All rights reserved.</a>
                            </div> -->
        <!--End Footer Copyright-->
        <!--Footer Payment Icon-->
        <!-- <div class="col-12 col-sm-12 col-md-6 col-lg-6 order-0 order-md-1 order-lg-1 order-sm-0 payment-icons text-right text-md-center"> -->
        <!-- <ul class="payment-icons list--inline">
                                    <li><i class="icon fa fa-cc-visa" aria-hidden="true"></i></li>
                                    <li><i class="icon fa fa-cc-mastercard" aria-hidden="true"></i></li>
                                    <li><i class="icon fa fa-cc-paypal" aria-hidden="true"></i></li>
                                </ul> -->
        <!-- </div> -->
        <!--End Footer Payment Icon-->
        <!-- </div>
                    </div>
                </div>
            </div>
        </footer> -->
        <!--End Footer-->

        <!--Scoll Top-->
        <span id="site-scroll"><i class="icon anm anm-angle-up-r"></i></span>
        <!--End Scoll Top-->

        <!-- Including Jquery -->
        <script src="assets/js/vendor/jquery-3.3.1.min.js"></script>
        <script src="assets/js/vendor/modernizr-3.6.0.min.js"></script>
        <script src="assets/js/vendor/jquery.cookie.js"></script>
        <script src="assets/js/vendor/wow.min.js"></script>
        <script src="assets/js/bootstrap.min.js"></script>
        <script src="assets/js/plugins.js"></script>
        <script src="assets/js/popper.min.js"></script>
        <script src="assets/js/lazysizes.js"></script>
        <script src="assets/js/main.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
        <script src="https://js.paystack.co/v1/inline.js"></script>
        <script>
            $(document).ready(function() {
                // logout
                $('#logoutForm').click(function(e) {
                    e.preventDefault();

                    $.ajax({
                        url: "./logic/logout.php",
                        type: "POST",
                        data: $("#logoutForm").serialize() + "&action=logout",
                        dataType: "json",
                        success: function(response) {
                            if (response.status === 'success') {
                                window.location.href = response.redirect;
                            } else {
                                swal.fire("Error", response.message, "error");
                            }
                        },
                        error: function(xhr, status, error) {
                            swal.fire("Error", response.message, "error");
                        }
                    });
                });

                // save book mechanic appointment script
                $('#save-book-mechanic-appointment-btn').click(function(e) {
                    e.preventDefault();
                    var form = $(this).closest('#book-appointment-model-form');
                    if (form.length > 0) {
                        alert('clicked');
                    } else {
                        alert('Form not found'); // Handle the case where the form doesn't exist
                    }

                    // var serviceId = $(this).data('service-id');
                    // var make = $('#make' + serviceId).val().trim();
                    // var model = $('#model' + serviceId).val().trim();
                    // var year = $('#year' + serviceId).val().trim();
                    // var plate = $('#plate' + serviceId).val().trim();
                    // var date = $('#date' + serviceId).val().trim();
                    // var note = $('#note' + serviceId).val().trim();
                    // var service = $('#service' + serviceId).val().trim();
                    // var mechanic = $('#mechanic' + serviceId).val().trim();
                    // var appointmentDate = new Date(date);
                    // var currentDate = new Date();
                    // var platePatternOne = /^[A-Za-z]{2}-[1-9]\d*-\d{2}$/;
                    // var platePatternTwo = /^[A-Za-z]{2}-[1-9]\d*-[A-Za-z]$/;
                    // var platePatternThree = /^[A-Za-z]+-\d+-\d{2}$/;
                    // var modal = '#exampleModal' + service;

                    // if (!validateYear(year)) {
                    //     swal.fire('Error', 'Invalid year. Please enter a valid year between 1900 and ' + new Date().getFullYear(), 'error');
                    //     return;
                    // }
                    // if (!platePatternOne.test(plate) && !platePatternTwo.test(plate) && !platePatternThree.test(plate)) {
                    //     swal.fire('Error', 'Car license plate number is required!', 'error');
                    //     return;
                    // }
                    // if (!(appointmentDate >= currentDate)) {
                    //     swal.fire('Error', 'Appointment date cannot be in the past!', 'error');
                    //     return;
                    // }
                    // if (make === '') {
                    //     swal.fire('Error', 'Car make is required!', 'error');
                    //     return;
                    // }
                    // if (model === '') {
                    //     swal.fire('Error', 'Car model is required!', 'error');
                    //     return;
                    // }
                    // if (date === '') {
                    //     swal.fire('Error', 'Date of appointment is required!', 'error');
                    //     return;
                    // }

                    // var formData = new FormData();
                    // formData.append('make', make);
                    // formData.append('model', model);
                    // formData.append('year', year);
                    // formData.append('plate', plate);
                    // formData.append('date', date);
                    // formData.append('note', note);
                    // formData.append('service', service);

                    // $.ajax({
                    //     url: 'logic/book-mechanic-appointment-logic.php',
                    //     type: 'POST',
                    //     data: formData,
                    //     dataType: 'json',
                    //     contentType: false,
                    //     processData: false,
                    //     success: function(response) {
                    //         Swal.fire('Success!', response.message, 'success').then(function() {
                    //             $("#book-appointment-model-form")[0].reset();
                    //             $(modal).modal('hide');
                    //         });
                    //     },
                    //     error: function(xhr, status, error) {
                    //         Swal.fire('Error!', 'An error occurred while booking appointment: ' + xhr.statusText, 'error');
                    //     }
                    // });
                });

                $('#exampleModal').on('show.bs.modal', function(e) {
                    var button = $(e.relatedTarget);
                    var serviceId = button.data('service-id');
                    var serviceName = button.data('service-name');
                    var price = button.data('price');
                    var duration = button.data('duration');
                    var contact = button.data('contact');
                    var town = button.data('town');
                    var location = button.data('location');

                    var modal = $(this);
                    modal.find('.modal-body').html(`<form id="book-appointment-model-form" method="post">
                                <input type="text" name="service" id="service" value="<?= $data['service_id']; ?>">
                                <input type="text" name="mechanic" id="mechanic" value="<?= $data['users_id']; ?>">
                                <small class="text-danger">Vehicle Details</small>
                                <div class="mb-3">
                                    <label for="make">Make</label>
                                    <div class="input-group">
                                        <input type="text" class="form-control" id="make" name="make" placeholder="e.g. Toyota, Honda">
                                    </div>
                                </div>

                                <div class="mb-3">
                                    <label for="model">Model</label>
                                    <div class="input-group">
                                        <input type="text" id="model" class="form-control" name="model" placeholder="e.g. Corolla, Civic">
                                    </div>
                                </div>

                                <div class="mb-3">
                                    <label for="year">Year</label>
                                    <div class="input-group">
                                        <input type="year" id="year" class="form-control" name="year" placeholder="2023">
                                    </div>
                                </div>

                                <div class="mb-3">
                                    <label for="plate">License Plate Number</label>
                                    <div class="input-group">
                                        <input type="text" id="plate" class="form-control" name="plate" placeholder="WR-1234-24">
                                    </div>
                                </div>
                                <small class="text-danger">Appointment Details</small>
                                <div class="mb-3">
                                    <label for="date">Date</label>
                                    <div class="input-group">
                                        <input type="date" id="date" class="form-control" name="date">
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <label for="note">Note</label>
                                    <div class="input-group">
                                        <textarea type="text" id="note" class="form-control" name="note" rows="2" placeholder="Special instructions or additional details for the appointment"></textarea>
                                    </div>
                                </div>

                                <button id="save-book-mechanic-appointment-btn" class="btn" name="save" data-service-id=""><i class="settings-save ti-save"></i> Save</button>
                            </form>`);
                });

                // add item to shopping cart script
                $('#addToCartBtn').click(function() {
                    // Get the values from the input fields
                    var productId = $('#product_id').val();
                    var productName = $('#product_name').val();
                    var productPrice = parseFloat($('#product_price').val());
                    var productImage = $('#product_image').val();
                    var quantity = parseInt($('#quantity-input').val());

                    var data = {
                        product_id: productId,
                        product_name: productName,
                        product_image: productImage,
                        product_price: productPrice,
                        quantity: quantity
                    };

                    $.ajax({
                        type: 'POST',
                        url: 'logic/add-to-cart.php',
                        data: data,
                        success: function(response) {
                            fetchCart();
                            updateCartCount();
                            updateSubtotal();
                            Swal.fire('Success!', 'Item added to cart!', 'success');
                        },
                        error: function(xhr, status, error) {
                            Swal.fire('Error!', 'An error occurred while adding item to cart!', 'error');
                        }
                    });
                });

                // Remove item from cart script
                $(".cart__remove").click(function(e) {
                    e.preventDefault();
                    var productId = $(this).data('product-id');
                    Swal.fire({
                        title: 'Remove Item',
                        text: 'Are you sure you want to remove this item from the cart?',
                        icon: 'warning',
                        showCancelButton: true,
                        confirmButtonText: 'Yes, remove it!',
                        cancelButtonText: 'Cancel',
                    }).then((result) => {
                        if (result.isConfirmed) {
                            removeItemFromCart(productId);
                        }
                    });
                });

                // confirm order and checkout
                $('#confirm-order').click(function(e) {
                    e.preventDefault();

                    var contact = $('#contact').val().trim();
                    var gps = $('#gps').val().trim();
                    var city = $('#city').val().trim();
                    var region = $('#region').val().trim();
                    var email = $('#customer-email').val().trim();
                    var amount = $('#order-total').val().trim();

                    amount = amount * 100;

                    if (contact === '') {
                        swal.fire('Erorr', 'Your phone number for transaction is required!', 'error');
                        return;
                    }
                    if (!validateContact(contact)) {
                        swal.fire("Error", "Please enter a valid contact number starting with 0 and containing 10 digits.", "error");
                        return;
                    }
                    if (!validateGPSAddress(gps)) {
                        swal.fire("Error", "Enter a valid GPS address. E.g: 'CE-301-4324'", "error");
                        return;
                    }
                    if (city === '') {
                        swal.fire('Error', 'Your city or town for delivery is required!', 'error');
                        return;
                    }
                    if (region === 'Select Region') {
                        swal.fire('Error', 'Select region of your city or town!', 'error');
                        return;
                    }

                    var formData = new FormData();
                    formData.append('contact', contact);
                    formData.append('gps_address', gps);
                    formData.append('city', city);
                    formData.append('region', region);

                    $.ajax({
                        type: "POST",
                        url: "logic/process-order-details.php",
                        data: formData,
                        dataType: "json",
                        contentType: false,
                        processData: false,
                        success: function(response) {
                            if (response.status === 'success') {
                                let ref = response.id;
                                payWithPaystack(contact, email, amount, ref);
                                // swal.fire('Success', 'Order successfully submitted!', 'success');
                            } else {
                                swal.fire('Error', 'Order submission failed. Please try again.', 'error');
                            }
                        },
                        error: function() {
                            swal.fire('Error', 'Unable to process your order. Please try again!', 'error');
                        }
                    });
                });

                // get user's orders
                $('.order-item').click(function() {
                    var orderId = $(this).data('order-id');

                    $.ajax({
                        url: 'logic/get-user-order-details.php',
                        type: 'POST',
                        data: {
                            order: orderId
                        },
                        dataType: 'json',
                        success: function(response) {
                            if (response.status === 'success') {
                                $('#orderNumber').text(formatDate(response.data[0].order_date) + ' Order Details');
                                // Update the order-details section with the fetched details
                                displayOrderDetails(response.data);
                            } else {
                                // Handle the error case
                                $('#order-details').html('Failed to load order details.');
                            }
                        }
                    });
                });

                // get user details
                function getUserDetails() {
                    $.ajax({
                        url: "logic/get-user-details.php",
                        type: "GET",
                        dataType: "json",
                        success: function(response) {
                            if (response.status === 'success') {

                                var userDetails = response.user;

                                // populate profile card
                                var fullName = userDetails.first_name + " " + userDetails.last_name;
                                fullName += userDetails.other_names ? " " + userDetails.other_names : " ";
                                $("#user-full-name").text(fullName);
                                $("#user-role").text(userDetails.users_role);
                                $("#user-contact").text(userDetails.users_contact);
                                $("#user-email").text(userDetails.users_email);

                                // populate update form
                                $("#first_name").val(userDetails.first_name);
                                $("#other_names").val(userDetails.other_names);
                                $("#last_name").val(userDetails.last_name);
                                $("#user_email").val(userDetails.users_email);
                                $("#user_contact").val(userDetails.users_contact);
                                $("#user_role").val(userDetails.users_role);

                                // Show the user profile card
                                $("#user-profile-card").show();
                            } else {
                                swal.fire("Error", response.message, "error");
                            }
                        },
                        error: function(xhr, status, error) {
                            swal.fire("Error", "An error occurred while fetching user details: " + error, "error");
                        }
                    });
                };

                // Update user details 
                $("#save-profile-btn").click(function(e) {
                    e.preventDefault();

                    // Get form inputs
                    var firstName = $("#first_name").val().trim();
                    var otherNames = $("#other_names").val().trim();
                    var lastName = $("#last_name").val().trim();
                    var userEmail = $("#user_email").val().trim();
                    var userContact = $("#user_contact").val().trim();

                    // Perform validation
                    if (firstName === "") {
                        swal.fire("Error", "Please enter your first name.", "error");
                        return;
                    }
                    if (lastName === "") {
                        swal.fire("Error", "Please enter your last name.", "error");
                        return;
                    }
                    if (userEmail === "") {
                        swal.fire("Error", "Please enter your email.", "error");
                        return;
                    }
                    if (userContact === "") {
                        swal.fire("Error", "Please enter your contact.", "error");
                        return;
                    }
                    if (!validateEmail(userEmail)) {
                        swal.fire("Error", "Please enter a valid email address.", "error");
                        return;
                    }
                    if (!validateContact(userContact)) {
                        swal.fire("Error", "Please enter a valid contact number starting with 0 and containing 10 digits.", "error");
                        return;
                    }

                    var formData = new FormData();
                    formData.append('first_name', firstName);
                    formData.append('last_name', lastName);
                    formData.append('other_names', otherNames);
                    formData.append('user_email', userEmail);
                    formData.append('user_contact', userContact);

                    // All inputs are valid, proceed with AJAX request
                    $.ajax({
                        url: "logic/update-user-logic.php",
                        type: "POST",
                        data: formData,
                        contentType: false,
                        processData: false,
                        dataType: "json",
                        success: function(response) {
                            // Handle the response and redirect
                            if (response.status === 'success') {
                                $("#update-profile-form")[0].reset();
                                swal.fire("Success", response.message, "success").then(function() {
                                    window.location.href = response.redirect;
                                });
                            } else {
                                swal.fire("Error", response.message, "error");
                            }
                        },
                        error: function(xhr, status, error) {
                            swal.fire("Error", "An error occurred while processing the request: " + error, "error");
                        }
                    });

                    // Email validation helper function
                    function validateEmail(email) {
                        var emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                        return emailPattern.test(email);
                    }

                    // Contact validation helper function
                    function validateContact(contact) {
                        var contactPattern = /^0\d{9}$/;
                        return contactPattern.test(contact);
                    }
                });

                // Change password 
                $("#save-password-btn").click(function(e) {
                    e.preventDefault();

                    var oldPassword = $("#old-password").val().trim();
                    var newPassword = $("#new-password").val().trim();
                    var conPassword = $("#con-new-password").val().trim();

                    if (oldPassword === "") {
                        swal.fire("Error", "Please enter your password.", "error");
                        return;
                    }
                    if (newPassword === "") {
                        swal.fire("Error", "Please enter your new password.", "error");
                        return;
                    }
                    if (conPassword === "") {
                        swal.fire("Error", "Please confirm your new password.", "error");
                        return;
                    }
                    if (oldPassword === newPassword) {
                        swal.fire("Error", "Cannot use old password as new password.", "error");
                        return;
                    }
                    if (newPassword !== conPassword) {
                        swal.fire("Error", "New password and confirm password do not match", "error");
                        return;
                    }

                    var formData = new FormData();
                    formData.append('old_password', oldPassword);
                    formData.append('new_password', newPassword);
                    formData.append('con_password', conPassword);

                    $.ajax({
                        url: "logic/change-password-logic.php",
                        type: "POST",
                        data: formData,
                        contentType: false,
                        processData: false,
                        dataType: "json",
                        success: function(response) {
                            if (response.status === 'success') {
                                $("#change-password-form")[0].reset();
                                swal.fire("Success", response.message, "success").then(function() {
                                    window.location.href = response.redirect;
                                });
                            } else {
                                swal.fire("Error", response.message, "error");
                            }
                        },
                        error: function(xhr, status, error) {
                            swal.fire("Error", "An error occurred while processing the request: " + error, "error");
                        }
                    });
                });

                // register store
                $("#register-store-btn").click(function(e) {
                    e.preventDefault();

                    var storeName = $("#store_name").val().trim();
                    var storeType = $("#store_type").val();
                    var storeEmail = $("#store_email").val().trim();
                    var storeContact = $("#store_contact").val().trim();
                    var gpsAddress = $("#store_gps_address").val().trim();
                    var streetName = $("#street_name").val().trim();
                    var storeTown = $("#store_town").val().trim();
                    var storeLocation = $("#store_location").val().trim();
                    var tncChecked = $("#tnc").is(":checked");

                    if (storeName === "") {
                        swal.fire("Error", "Please enter the store name.", "error");
                        return;
                    }
                    if (storeType === "") {
                        swal.fire("Error", "Please select the store type.", "error");
                        return;
                    }
                    if (storeEmail === "" || !validateEmail(storeEmail)) {
                        swal.fire("Error", "Please enter a valid email address.", "error");
                        return;
                    }
                    if (gpsAddress === "" || !validateGPSAddress(gpsAddress)) {
                        swal.fire("Error", "Invalid GPS address format.", "error");
                        return;
                    }
                    if (!validateContact(storeContact)) {
                        swal.fire("Error", "Please enter a valid contact number starting with 0 and containing 10 digits.", "error");
                        return;
                    }
                    if (streetName === "") {
                        swal.fire("Error", "Please enter the street name.", "error");
                        return;
                    }
                    if (storeTown === "") {
                        swal.fire("Error", "Please enter the town of your store.", "error");
                        return;
                    }

                    if (!tncChecked) {
                        swal.fire("Error", "Please agree to the Terms & Conditions.", "error");
                        return;
                    }

                    var formData = new FormData();
                    formData.append('store_name', storeName);
                    formData.append('store_type', storeType);
                    formData.append('store_email', storeEmail);
                    formData.append('store_contact', storeContact);
                    formData.append('store_town', storeTown);
                    formData.append('store_location', storeLocation);
                    formData.append('gps_address', gpsAddress);
                    formData.append('street_name', streetName);

                    $.ajax({
                        url: "../logic/store-logic.php",
                        type: "POST",
                        data: formData,
                        dataType: 'json',
                        contentType: false,
                        processData: false,
                        success: function(response) {
                            if (response.status === "success") {
                                $("#CustomerLoginForm")[0].reset();
                                swal.fire("Success", response.message, "success");
                                if (response.redirect) {
                                    window.location.href = response.redirect;
                                }
                            } else {
                                swal.fire("Error", response.message, "error");
                            }
                        },
                        error: function(xhr, status, error) {
                            swal.fire("Error", "An error occurred while processing the request: " + error, "error");
                        }
                    });
                });

            });


            function displayOrderDetails(orderDetails) {
                var detailsHtml = '';
                var deliveryHtml = '';
                var totalAmount = 0;

                // Loop through each item in the order details
                orderDetails.forEach(function(item) {
                    totalAmount += parseFloat(item.subtotal);

                    // Build the HTML for each item
                    detailsHtml += '<div class="card rounded-0 mb-3">';
                    detailsHtml += '';
                    detailsHtml += '<div class="row g-0">';
                    detailsHtml += '<div class="col-md-4">';
                    detailsHtml += '<img src="uploads/' + item.image + '" class="img-fluid" alt="' + item.name + '">';
                    detailsHtml += '</div>';
                    detailsHtml += '<div class="col-md-8">';
                    detailsHtml += '<div class="card-body">';
                    detailsHtml += '<h5 class="card-title">' + item.name + '</h5>';
                    detailsHtml += '<p class="card-text position-absolute top-0 end-0 pt-3 px-5">&#x20B5;' + item.item_price + '</p>';
                    detailsHtml += '<p class="card-text"><small class="text-body-secondary">' + ((item.quantity === 1) ? 'Quantity ' : 'Quantities ') + item.quantity + '</small></p>';
                    detailsHtml += '</div>';
                    detailsHtml += '</div>';
                    detailsHtml += '</div>';
                    detailsHtml += '</div>';
                });

                // Add the total amount to the detailsHtml
                detailsHtml += '<p class="text-end"><strong>Total Amount: &#x20B5;' + totalAmount.toFixed(2) + '</strong></p>';

                deliveryHtml += '<div class="card rounded-0 mt-3">';
                deliveryHtml += '<div class="card-body">';
                deliveryHtml += '<h5 class="card-title">Delivery Information</h5>';
                deliveryHtml += '<p>Transaction wallet ' + orderDetails[0].contact + ' </p>';
                deliveryHtml += '<p>Delivery town/city ' + orderDetails[0].city + ' </p>';
                deliveryHtml += '<p>' + orderDetails[0].region + ' Region</p>';
                deliveryHtml += '<address>GPS Address ' + orderDetails[0].gps_address + '</address>';
                deliveryHtml += '</div>';
                deliveryHtml += '</div>';

                // Update the order-details section
                $('#order-details').html(detailsHtml);
                $('#delivery-details').html(deliveryHtml);
            }

            function daySuffix(day) {
                if (day >= 11 && day <= 13) {
                    return 'th';
                }
                switch (day % 10) {
                    case 1:
                        return 'st';
                    case 2:
                        return 'nd';
                    case 3:
                        return 'rd';
                    default:
                        return 'th';
                }
            }

            function formatDate(dateTime) {
                const options = {
                    hour: '2-digit',
                    minute: '2-digit'
                };
                const date = new Date(dateTime);
                const day = date.getDate();
                const month = date.toLocaleDateString('en-GB', {
                    month: 'long'
                });
                const year = date.getFullYear();
                const time = date.toLocaleTimeString('en-US', options);

                const formattedDate = `${day}${daySuffix(day)} ${month}, ${year}. ${time}`;
                return formattedDate;
            }

            // Function to initiate order payment
            function payWithPaystack(contact, email, amount, ref) {
                var handler = PaystackPop.setup({
                    key: 'pk_test_d8da306e7a9d966b9c052892ae40e728371ddeee',
                    email: email,
                    amount: amount,
                    currency: 'GHS',
                    ref: ref,
                    metadata: {
                        custom_fields: [{
                            display_name: "Contact",
                            variable_name: "contact",
                            value: contact,
                        }],
                    },
                    callback: function(response) {
                        $.ajax({
                            type: 'POST',
                            url: 'logic/verify-payment.php',
                            data: {
                                transaction_reference: response.reference
                            },
                            dataType: 'json',
                            success: function(response) {

                                if (response.status === 'success') {
                                    swal.fire('Success', response.message, 'success');
                                } else {
                                    swal.fire('Error', response.message, 'error');
                                }
                            },
                            error: function(response) {
                                swal.fire('Error', 'An error occurred during payment verification!', 'error');
                            }
                        });
                    },
                    onClose: function() {
                        $.ajax({
                            type: 'POST',
                            url: 'logic/cancel-payment.php',
                            data: {
                                ref: ref
                            },
                            dataType: 'json',
                            success: function(response) {
                                console.log(response);
                                if (response.status === 'success') {
                                    swal.fire('Erorr', response.message, 'error');
                                } else {
                                    swal.fire('Error', response.message, 'error');
                                }
                            },
                            error: function() {
                                swal.fire('Error', 'An error occurred during cancelling your transaction!', 'error');
                            }
                        });
                    },
                });

                handler.openIframe();
            }

            // GPS address validation helper function
            function validateGPSAddress(gpsAddress) {
                if (gpsAddress === null || gpsAddress === undefined || gpsAddress === '') {
                    return true; // Allow null or empty GPS addresses
                }

                var gpsPattern = /^[a-zA-Z]{2}-\d{3,4}-\d{3,4}$/;
                return gpsPattern.test(gpsAddress);
            }

            // Contact validation helper function
            function validateContact(contact) {
                var contactPattern = /^0\d{9}$/;
                return contactPattern.test(contact);
            }

            // function for validating years
            function validateYear(yearInput) {
                if (!yearInput) {
                    return true;
                }

                var year = parseInt(yearInput, 10);
                var currentYear = new Date().getFullYear();

                if (isNaN(year) || year < 1900 || year > currentYear) {
                    return false;
                }
                return true;
            }

            // Email validation helper function
            function validateEmail(email) {
                var emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                return emailPattern.test(email);
            }

            // Function to fetch and update the cart
            function fetchCart() {
                $.ajax({
                    url: 'logic/fetch-cart.php',
                    type: 'GET',
                    dataType: 'json',
                    success: function(data) {
                        updateCartItems(data);
                    },
                    error: function() {
                        swal.fire("Error", "Error fetching cart data!", "error");
                    }
                });
            }

            // Function to update the cart items
            function updateCartItems(cartData) {
                var cartItemsHtml = '';
                var totalAmount = 0;

                $.each(cartData, function(index, item) {
                    var cartItemHtml = '<li class="item">';
                    cartItemHtml += '<a class="product-image" href="#"><img src="uploads/' + item.image + '" alt="" /></a>';
                    cartItemHtml += '<div class="product-details">';
                    cartItemHtml += '<a class="cart__remove float-right" data-product-id="' + item.id + '"><i class="anm anm-times-l" aria-hidden="true"></i></a>';
                    cartItemHtml += '<a class="pName" href="#"><h3>' + item.name + '</h3></a>';
                    cartItemHtml += '<div class="priceRow"><div class="product-price"><span class="money"><em>price: ₵;' + item.price + '</em></span></div></div>';
                    cartItemHtml += '<div class="wrapQtyBtn"><div class="qtyField"><span class="label">Qty: ' + item.quantity + '</span></div></div>';
                    var itemAmount = item.price * item.quantity;
                    cartItemHtml += '<div class="amountRow"><div class="amount"><span class="money" id="amount"><b>Total: ₵;' + itemAmount.toFixed(2) + '</b></span></div></div>';
                    cartItemHtml += '</div></li>';

                    // Add item amount to the total amount
                    totalAmount += itemAmount;

                    cartItemsHtml += cartItemHtml;
                });

                // Update the cart items in the HTML
                $('#cart-items').html(cartItemsHtml);

                // Enable or disable the checkout button based on cart contents
                if (cartData.length > 0) {
                    $('#cartCheckout').prop('disabled', false);

                    // Show the total section
                    $('.total').show();
                } else {
                    $('#cartCheckout').prop('disabled', true);

                    // Hide the total section if cart is empty
                    $('.total').hide();
                }

                // Update the total amount in the mini cart
                $('#totalAmountMini').text('₵' + totalAmount.toFixed(2));
            }

            // Function to update the subtotal for cart
            function updateSubtotal() {
                var totalAmount = 0;
                $('.product-amount').each(function() {
                    var amountText = $(this).find('.money b').text();
                    var amount = parseFloat(amountText.replace(/[^\d.]/g, ''));
                    totalAmount += amount;
                });
                $('#totalAmount').text('₵' + totalAmount.toFixed(2));
            }

            // Function to remove an item from the cart
            function removeItemFromCart(productId) {
                $.ajax({
                    type: 'POST',
                    url: 'logic/remove-from-cart.php',
                    data: {
                        product_id: productId
                    },
                    success: function(response) {
                        if (response === 'success') {
                            $('tr[data-product-id="' + productId + '"]').remove();
                            fetchCart();
                            updateCartCount();
                            updateSubtotal();
                            Swal.fire('Removed!', 'Item has been removed from the cart!', 'success');
                        } else {
                            Swal.fire('Error!', 'An error occurred while removing the item!', 'error');
                        }
                    },
                    error: function(xhr, status, error) {
                        Swal.fire('Error!', 'An error occurred while communicating with the server!', 'error');
                    }
                });
            }

            // Function to fetch and update the cart count
            function updateCartCount() {
                $.ajax({
                    url: 'logic/get-cart-count.php',
                    type: 'GET',
                    dataType: 'json',
                    success: function(data) {
                        $('#cartItemCount').text(data.count);
                    },
                    error: function() {
                        Swal.fire('Error!', 'Error fetching cart count!', 'error');
                    }
                });
            }

            fetchCart();
            updateCartCount();
            updateSubtotal();
            // setInterval(fetchCart, 3000);


            document.addEventListener("DOMContentLoaded", function() {
                // Check if the cart is empty 
                <?php $cartIsEmpty = empty($_SESSION['cart']); ?>
                var cartIsEmpty = <?php echo $cartIsEmpty ? 'true' : 'false'; ?>;
                var contactInput = document.getElementById('contact');
                var gpsInput = document.getElementById('gps');
                var cityInput = document.getElementById('city');
                var regionSelect = document.getElementById('region');
                var payOrderButton = document.getElementById('pay-order');

                // Disable or enable form elements based on cartIsEmpty
                if (contactInput) {
                    contactInput.disabled = cartIsEmpty;
                }
                if (gpsInput) {
                    gpsInput.disabled = cartIsEmpty;
                }
                if (cityInput) {
                    cityInput.disabled = cartIsEmpty;
                }
                if (regionSelect) {
                    regionSelect.disabled = cartIsEmpty;
                }
                if (payOrderButton) {
                    payOrderButton.disabled = cartIsEmpty;
                }


                // product quanity adjustment
                const quantityInput = document.getElementById("quantity-input");
                const qtyMinusBtn = document.getElementById("qtyMinusBtn");
                const qtyPlusBtn = document.getElementById("qtyPlusBtn");

                // Increment quantity value
                qtyPlusBtn.addEventListener("click", function() {

                    let quantity = parseInt(quantityInput.value);
                    if (quantity < 1) {
                        quantity = 1;
                    } else {
                        quantity += 1;
                    }
                    quantityInput.value = quantity;
                });

                // Decrement quantity value
                qtyMinusBtn.addEventListener("click", function() {
                    let quantity = parseInt(quantityInput.value);
                    if (quantity > 1) {
                        quantity -= 1;
                    }
                    quantityInput.value = quantity;
                });
            });
        </script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
        </div>
        </body>

        </html>